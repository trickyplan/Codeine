<?php

    /* Codeine
     * @author BreathLess
     * @description  
     * @package Codeine
     * @version 7.x
     */

    setFn('Check', function ($Call)
    {
        $Call['Scan'] = json_decode(F::Run('IO', 'Write',
             [
                 'Storage' => 'Web',
                 'Where' => 'https://www.virustotal.com/vtapi/v2/url/scan',
                 'Data' =>
                     [
                         'apikey' => '058a90c9a1ecb024cdc3f11dde2e90c469deb1760abe38994e20db0e4e15093f',
                         'url' => 'http://trickyplan.ru/img/logo.png'
                     ]
             ]),true);

        return $Call['Scan']['scan_id'];
    });


    setFn('Report', function ($Call)
    {
        $Report = json_decode(F::Run('IO', 'Write',
                 [
                     'Storage' => 'Web',
                     'Where' => 'http://www.virustotal.com/vtapi/v2/url/report',
                     'Data' =>
                         [
                             'apikey' => '058a90c9a1ecb024cdc3f11dde2e90c469deb1760abe38994e20db0e4e15093f',
                             'resource' => $Call['Value']
                         ]
                 ]),true);

        if ($Report['response_code'] == 1)
        {
            if ($Report['positives'] == 0)
                return 'Clean';
            else
                return 'Danger';
        }
        else
            return 'Scanning';
    });